# Google ドライブ フォルダ監視・自動通知システム V2

Google ドライブの特定フォルダに新しいファイルやフォルダが追加された際に、自動でメール通知を送信するGoogle Apps Script（GAS）プログラムです。

**GitHubリポジトリ**: https://github.com/itoksk/drive-app

**サンプルスプレッドシート（閲覧用）**: https://docs.google.com/spreadsheets/d/1zS9AWg4DEpIIx0w4QaDm8RBFrLdmnNCjl6YFUd7QXSM/edit?usp=sharing

**元の記事（note）**: https://note.com/tyaperujp01/n/n66ac3a2dfe32

---

## こんな人におすすめ

- 会議資料フォルダに新しいファイルが追加されたら通知がほしい
- 共有フォルダの更新をチームに自動で知らせたい
- プログラミングは苦手だけど、業務を自動化したい

---

## V2の特徴

### カスタムメニューで簡単操作

スプレッドシートを開くと「ドライブ監視」メニューが表示されます。
プログラミングの知識がなくても、メニューから操作できます。

| メニュー | できること |
|---------|-----------|
| 初期セットアップ | 必要なシートとヘッダーを自動作成 |
| 今すぐチェック実行 | 手動でフォルダをチェック |
| 自動実行設定 | 1時間/6時間/毎日の定期実行を設定 |
| サンプル行を追加 | 入力例を追加 |
| 使い方を表示 | ヘルプを表示 |

### 改善された機能

1. **共有ドライブ対応** - Google Workspaceの共有ドライブも監視可能
2. **URL処理の改善** - URLをそのまま貼り付けてOK
3. **シート作成の改善** - 特殊文字があっても自動で対応
4. **エラー表示** - 問題があればG列にわかりやすく表示
5. **重複防止** - 同じシートが何度も作られない

---

## 3ステップで始める

### ステップ1: スプレッドシートを準備

1. 新しいGoogleスプレッドシートを作成
2. 「拡張機能」→「Apps Script」を開く
3. `Code.gs`の内容をコピー＆ペーストして保存

### ステップ2: 初期セットアップ

1. スプレッドシートに戻る
2. メニュー「ドライブ監視」→「初期セットアップ」をクリック
3. 権限を承認（初回のみ）

### ステップ3: フォルダを登録して実行

1. A列のチェックボックスをON
2. B列に監視したいフォルダのURLを貼り付け
3. F列に通知先メールアドレスを入力
4. 「ドライブ監視」→「今すぐチェック実行」

**詳しい手順は [手順書.md](手順書.md) をご覧ください。**

---

## スプレッドシートの列説明

| 列 | 内容 | 入力 |
|----|------|------|
| A列 | 有効化（チェックボックス） | 自分で入力 |
| B列 | フォルダのURL | 自分で入力 |
| C列 | フォルダ名 | 自動 |
| D列 | 最終更新日時 | 自動 |
| E列 | オーナー | 自動 |
| F列 | メール送信先 | 自分で入力 |
| G列 | エラー | 自動 |

---

## よくある質問

### Q: 既存のファイルも通知されますか？

**A:** いいえ。初回実行後に**新しく追加されたファイルのみ**通知されます。

### Q: 複数のフォルダを監視できますか？

**A:** はい。mainシートに複数行追加すれば、それぞれのフォルダを監視できます。

### Q: 共有ドライブで動かない

**A:** Apps Scriptの「サービス」からDrive APIを追加してください。詳しくは[手順書.md](手順書.md)をご覧ください。

### Q: メールが届かない

**A:** 以下を確認してください：
1. F列にメールアドレスが入力されているか
2. 権限の承認が完了しているか
3. 新しいファイルを追加してから再実行したか

---

## 困ったときは

1. **G列を確認** - エラーメッセージが表示されています
2. **手順書を確認** - [手順書.md](手順書.md)のトラブルシューティングをご覧ください
3. **質問する** - [GitHubのIssues](https://github.com/itoksk/drive-app/issues)または[元のnote記事](https://note.com/tyaperujp01/n/n66ac3a2dfe32)のコメントへ

---

## 更新履歴

### 2026年2月3日 - V2リリース

- カスタムメニューを追加（初期セットアップ、自動実行設定など）
- 共有ドライブ対応（Drive API使用）
- URL処理の改善
- シート作成処理の改善
- エラーハンドリングの強化
- パフォーマンス改善

---

## ライセンス

このプログラムは教育目的・業務改善目的で自由に使用・改変できます。
